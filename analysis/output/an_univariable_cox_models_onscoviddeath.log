---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Github\opencorona-risk-factors-research\analysis\output/an_univariable_cox_models_onscoviddeath.log
  log type:  text
 opened on:  24 Apr 2020, 00:02:39

. 
. use egdata, clear
(Poor factors dummy analysis dataset)

. 
. ***************************
. *  Run Age and sex  models*
. ***************************
. 
.         stset stime_`outcome', fail(`outcome') enter(enter_date) origin(enter_date) id(patient_id) 

                id:  patient_id
     failure event:  onscoviddeath != 0 & onscoviddeath < .
obs. time interval:  (stime_onscoviddeath[_n-1], stime_onscoviddeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
    100,570  total observations
          3  observations end on or before enter()
------------------------------------------------------------------------------
    100,567  observations remaining, representing
    100,567  subjects
          1  failure in single-failure-per-subject data
  6,536,671  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =        65

. 
.         * Cox model for age
.         capture stcox age1 age2 age3 i.male, strata(stp) 

.         if _rc==0 {
.                 estimates
.                 estimates save ./output/models/an_univariable_cox_models_`outcome'_AGESPLSEX_, replace
.                 est store base
.                 estat ic
.         }       

.         else di "WARNING - AGESPL SEX vs `outcome' MODEL DID NOT SUCCESSFULLY FIT"
WARNING - AGESPL SEX vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT

. 
. 
.         capture stcox ib3.agegroup i.male, strata(stp) 

.         if _rc==0 {
.                 estimates

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =      100,567                  Number of obs    =     100,567
No. of failures =            1
Time at risk    =      6536671
                                                LR chi2(6)       =        3.75
Log likelihood  =   -9.6438745                  Prob > chi2      =      0.7105

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     18-<40  |   .0060373    1439351    -0.00   1.000            0           .
     40-<50  |   .0095391    3244011    -0.00   1.000            0           .
     60-<70  |   .0089799    3473052    -0.00   1.000            0           .
     70-<80  |   .0087446    3608611    -0.00   1.000            0           .
        80+  |   4.12e+14   1.26e+22     0.00   1.000            0           .
             |
      1.male |   4.80e-16   3.72e-08    -0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
.                 estimates save ./output/models/an_univariable_cox_models_`outcome'_AGEGROUPSEX_, replace
file ./output/models/an_univariable_cox_models_onscoviddeath_AGEGROUPSEX_.ster saved
.                 estat ic

Akaike's information criterion and Bayesian information criterion

-----------------------------------------------------------------------------
       Model |        Obs  ll(null)  ll(model)      df         AIC        BIC
-------------+---------------------------------------------------------------
           . |    100,567 -11.51858  -9.643875       6    31.28775   88.39923
-----------------------------------------------------------------------------
               Note: N=Obs used in calculating BIC; see [R] BIC note.
.         }

.         else di "WARNING - AGEGROUP SEX vs `outcome' MODEL DID NOT SUCCESSFULLY FIT"

. 
. 
. *****************************************
. *  Loop through Age, sex  + 1 VAR models*
. *****************************************
. 
.         foreach var of any `listofvars' {               
  2.                 local b
  3.                 if "`var'"=="bmicat" local b "b2" /*group 2 is the baseline for BMI, baseline for all others is lowest level*/
  4.                 timer clear
  5.                 timer on 1
  6.                 capture stcox age1 age2 age3 male i`b'.`var', strata(stp) 
  7.                 if _rc==0 {
  8.                         estimates
  9.                         estimates save ./output/models/an_univariable_cox_models_`outcome'_AGESPLSEX_`var', replace
 10.                 }
 11.                 else di "WARNING - `var' vs `outcome' MODEL DID NOT SUCCESSFULLY FIT"
 12.                 timer off 1
 13.                 timer list
 14.                 } /*end of looping round vars for 1 var at a time models*/

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =       10,382                  Number of obs    =      10,382
No. of failures =            0
Time at risk    =       674830
                                                LR chi2(0)       =        0.00
Log likelihood  =            0                  Prob > chi2      =           .

---------------------------------------------------------------------------------------
                   _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
                 age1 |          1  (omitted)
                 age2 |          1  (omitted)
                 age3 |          1  (omitted)
                 male |          1  (omitted)
                      |
               bmicat |
 Underweight (<18.5)  |          1  (omitted)
Overweight (25-29.9)  |          1  (omitted)
   Obese I (30-34.9)  |          1  (omitted)
  Obese II (35-39.9)  |          1  (omitted)
     Obese III (40+)  |          1  (omitted)
---------------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_bmicat.ster not found)
file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_bmicat.ster saved
   1:      0.33 /        1 =       0.3290
WARNING - obese40 vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.40 /        1 =       2.3950

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =       42,017                  Number of obs    =      42,017
No. of failures =            0
Time at risk    =      2731105
                                                LR chi2(0)       =        0.00
Log likelihood  =            0                  Prob > chi2      =           .

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |          1  (omitted)
        age2 |          1  (omitted)
        age3 |          1  (omitted)
        male |          1  (omitted)
             |
       smoke |
    Current  |          1  (omitted)
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_smoke.ster not found)
file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_smoke.ster saved
   1:      0.60 /        1 =       0.5990
WARNING - currentsmoke vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.79 /        1 =       2.7890

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =       20,585                  Number of obs    =      20,585
No. of failures =            0
Time at risk    =      1338025
                                                LR chi2(0)       =        0.00
Log likelihood  =            0                  Prob > chi2      =           .

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |          1  (omitted)
        age2 |          1  (omitted)
        age3 |          1  (omitted)
        male |          1  (omitted)
             |
   ethnicity |
South Asian  |          1  (omitted)
      Black  |          1  (omitted)
      Other  |          1  (omitted)
      Mixed  |          1  (omitted)
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_ethnicity.ster not found)
file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_ethnicity.ster saved
   1:      0.45 /        1 =       0.4540
WARNING - imd vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.55 /        1 =       2.5510
WARNING - bpcat vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.94 /        1 =       2.9390
WARNING - bphigh vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.28 /        1 =       2.2830

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =      100,567                  Number of obs    =     100,567
No. of failures =            1
Time at risk    =      6536671
                                                LR chi2(0)       =       11.39
Log likelihood  =   -5.8257957                  Prob > chi2      =           .

-----------------------------------------------------------------------------------------------
                           _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   5.37e-18          .        .       .            .           .
                         age2 |   6.01e+58          .        .       .            .           .
                         age3 |   1.4e-185          .        .       .            .           .
                         male |   .0001861          .        .       .            .           .
1.chronic_respiratory_disease |   .0002695          .        .       .            .           .
-----------------------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_chronic_respiratory_disease.ster not found)
file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_chronic_respiratory_disease.ster saved
   1:     11.93 /        1 =      11.9320
WARNING - asthma vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.30 /        1 =       2.3030
WARNING - chronic_cardiac_disease vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.39 /        1 =       2.3900
WARNING - diabetes vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      3.45 /        1 =       3.4480
WARNING - cancer_exhaem_lastyr vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.26 /        1 =       2.2560
WARNING - haemmalig_aanaem_bmtrans_lastyr vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.18 /        1 =       2.1770

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =      100,567                  Number of obs    =     100,567
No. of failures =            1
Time at risk    =      6536671
                                                LR chi2(0)       =       11.49
Log likelihood  =   -5.7737484                  Prob > chi2      =           .

-----------------------------------------------------------------------------------------
                     _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   5.02e-18          .        .       .            .           .
                   age2 |   7.53e+58          .        .       .            .           .
                   age3 |   8.1e-186          .        .       .            .           .
                   male |   .0001727          .        .       .            .           .
1.chronic_liver_disease |   .4158238          .        .       .            .           .
-----------------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_chronic_liver_disease.ster not found)
file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_chronic_liver_disease.ster saved
   1:     18.57 /        1 =      18.5730

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =      100,567                  Number of obs    =     100,567
No. of failures =            1
Time at risk    =      6536671
                                                LR chi2(0)       =       11.40
Log likelihood  =   -5.8197689                  Prob > chi2      =           .

-----------------------------------------------------------------------------------
               _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |   5.29e-18          .        .       .            .           .
             age2 |   6.36e+58          .        .       .            .           .
             age3 |   1.2e-185          .        .       .            .           .
             male |   .0001687          .        .       .            .           .
1.stroke_dementia |   .0040918          .        .       .            .           .
-----------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_stroke_dementia.ster not found)
file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_stroke_dementia.ster saved
   1:     19.21 /        1 =      19.2090
WARNING - other_neuro vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.79 /        1 =       2.7950
WARNING - chronic_kidney_disease vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      2.24 /        1 =       2.2420
WARNING - organ_transplant vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      3.31 /        1 =       3.3130
WARNING - spleen vs onscoviddeath MODEL DID NOT SUCCESSFULLY FIT
   1:      3.03 /        1 =       3.0330

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =      100,567                  Number of obs    =     100,567
No. of failures =            1
Time at risk    =      6536671
                                                LR chi2(0)       =       11.45
Log likelihood  =   -5.7955207                  Prob > chi2      =           .

------------------------------------------------------------------------------------
                _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   4.95e-18          .        .       .            .           .
              age2 |   8.24e+58          .        .       .            .           .
              age3 |   5.6e-186          .        .       .            .           .
              male |   .0001813          .        .       .            .           .
1.ra_sle_psoriasis |   .0002009          .        .       .            .           .
------------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_ra_sle_psoriasis.ster not found)
file ./output/models/an_univariable_cox_models_onscoviddeath_AGESPLSEX_ra_sle_psoriasis.ster saved
   1:     17.40 /        1 =      17.4010

. 
. 
. 
. 
. * Close log file
. log close
      name:  <unnamed>
       log:  C:\Github\opencorona-risk-factors-research\analysis\output/an_univariable_cox_models_onscoviddeath.log
  log type:  text
 closed on:  24 Apr 2020, 00:04:31
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
