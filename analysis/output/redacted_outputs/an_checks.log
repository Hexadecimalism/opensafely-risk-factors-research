-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\opencorona-risk-factors-research\analysis\output/an_ch
> ecks.log
  log type:  text
 opened on:  22 Apr 2020, 08:33:27

. 
. * Open Stata dataset
. use egdata, clear
(Poor factors dummy analysis dataset)

. 
. 
. 
. ******************************************
. *  Check variables take expected values  *
. ******************************************
. 
. * Age
. datacheck age<., nol

. *assert inrange(age, 18, 105)
. datacheck inlist(agegroup, 1, 2, 3, 4, 5, 6), nol

. datacheck inlist(age70, 0, 1), nol

. 
. * Sex
. datacheck inlist(male, 0, 1), nol

. 
. * BMI 
. * assert inrange(bmi, 10, 200) | bmi==.
. datacheck inlist(obese40, 0, 1), nol

. datacheck inlist(bmicat, 1, 2, 3, 4, 5, 6, .u), nol

. 
. * IMD
. datacheck inlist(imd, 1, 2, 3, 4, 5, .u), nol

. 
. * Ethnicity
. datacheck inlist(ethnicity, 1, 2, 3, 4, 5, .u), nol

. 
. * Smoking
. datacheck inlist(smoke, 1, 2, 3, .u), nol

. datacheck inlist(currentsmoke, 0, 1), nol

. 
. * Blood pressure
. datacheck inlist(bpcat, 1, 2, 3, 4, .u), nol

. 
. 
. 
. 
. 
. ***************************************
. *  Cross-check logical relationships  *
. ***************************************
. 
. 
. * BMI
. bysort bmicat: summ bmi

-------------------------------------------------------------------------------
-> bmicat = Underweight (<18.5)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    313,165     17.4236    .8291724         15       18.4

-------------------------------------------------------------------------------
-> bmicat = Normal (18.5-24.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  4,814,219    22.37139    1.711549       18.5       24.9

-------------------------------------------------------------------------------
-> bmicat = Overweight (25-29.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  4,729,468    27.27517    1.413898         25       29.9

-------------------------------------------------------------------------------
-> bmicat = Obese I (30-34.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |  2,406,945    32.08343    1.416602         30       34.9

-------------------------------------------------------------------------------
-> bmicat = Obese II (35-39.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    930,573    37.05091    1.405981         35       39.9

-------------------------------------------------------------------------------
-> bmicat = Obese III (40+)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |    467,124    43.38429    2.637071         40         50

-------------------------------------------------------------------------------
-> bmicat = Unknown (.u)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |          0


. tab bmicat obese40, m

                     |  Severely obese (cat
                     |          3)
         Grouped BMI |         0          1 |     Total
---------------------+----------------------+----------
 Underweight (<18.5) |   313,165          0 |   313,165 
  Normal (18.5-24.9) | 4,814,219          0 | 4,814,219 
Overweight (25-29.9) | 4,729,468          0 | 4,729,468 
   Obese I (30-34.9) | 2,406,945          0 | 2,406,945 
  Obese II (35-39.9) |   930,573          0 |   930,573 
     Obese III (40+) |         0    467,124 |   467,124 
        Unknown (.u) | 3,766,266          0 | 3,766,266 
---------------------+----------------------+----------
               Total |16,960,636    467,124 |17,427,760 

. 
. * Age
. bysort agegroup: summ age

-------------------------------------------------------------------------------
-> agegroup = 18-<40

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  5,991,596    29.19362    6.200892         18         39

-------------------------------------------------------------------------------
-> agegroup = 40-<50

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,875,918    44.59207    2.923506         40         49

-------------------------------------------------------------------------------
-> agegroup = 50-<60

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  3,069,491    54.42831    2.843708         50         59

-------------------------------------------------------------------------------
-> agegroup = 60-<70

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  2,405,708    64.29701    2.885018         60         69

-------------------------------------------------------------------------------
-> agegroup = 70-<80

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  1,948,230    73.95381    2.758915         70         79

-------------------------------------------------------------------------------
-> agegroup = 80+

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |  1,136,817    85.30392    4.420559         80        105


. tab agegroup age70, m

   Grouped |  70 years and older
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,991,596          0 | 5,991,596 
    40-<50 | 2,875,918          0 | 2,875,918 
    50-<60 | 3,069,491          0 | 3,069,491 
    60-<70 | 2,405,708          0 | 2,405,708 
    70-<80 |         0  1,948,230 | 1,948,230 
       80+ |         0  1,136,817 | 1,136,817 
-----------+----------------------+----------
     Total |14,342,713  3,085,047 |17,427,760 

. 
. * Smoking
. tab smoke currentsmoke, m

     Smoking |    Current smoker
      status |         0          1 |     Total
-------------+----------------------+----------
       Never | 5,225,538          0 | 5,225,538 
      Former | 7,320,842          0 | 7,320,842 
     Current |         0  2,929,669 | 2,929,669 
Unknown (.u) | 1,951,711          0 | 1,951,711 
-------------+----------------------+----------
       Total |14,498,091  2,929,669 |17,427,760 

. 
. 
. 
. *********************
. *  Summarise dates  *
. *********************
. 
. * BMI
. summ bmi_date_measured, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
bmi_date_m~d | 13,839,957   16aug2017    1872.323  15jan2010  15jul9935

. 
. * Dates of comorbidities  
. foreach var of varlist  chronic_respiratory_disease     ///
>                                                 chronic_cardiac_disease      
>            ///
>                                                 diabetes                     
>                            ///
>                                                 lung_cancer                  
>                    ///
>                                                 haem_cancer                  
>                            ///
>                                                 other_cancer                 
>                    ///
>                                                 bone_marrow_transplant       
>            ///
>                                                 chemo_radio_therapy          
>            ///
>                                                 chronic_liver_disease        
>            ///
>                                                 chronic_kidney_disease       
>            ///
>                                                 organ_transplant             
>                    ///     
>                                                 dysplenia                    
>                            ///
>                                                 sickle_cell                  
>                    ///
>                                                 ra_sle_psoriasis  {
  2. 
.         summ `var'_date, format
  3.         bysort `var': summ `var'_date
  4. }

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_r~te |    721,810   26mar2009    6229.957  15jan1800  15apr2020

-------------------------------------------------------------------------------
-> chronic_respiratory_disease = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_r~te |     10,499    21977.39    18.60896      21960      22020

-------------------------------------------------------------------------------
-> chronic_respiratory_disease = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_r~te |    711,311     17923.4    6256.691     -58424      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_c~te |  1,188,537   30sep2006     6539.47  15jan1840  15sep2106

-------------------------------------------------------------------------------
-> chronic_cardiac_disease = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_c~te |     15,183    21979.61    257.2051      21960      53583

-------------------------------------------------------------------------------
-> chronic_cardiac_disease = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_c~te |  1,173,354    17011.28    6557.579     -43815      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
diabetes_d~e |  1,754,819   05dec2008    6406.909  15jan1860  15apr2020

-------------------------------------------------------------------------------
-> diabetes = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
diabetes_d~e |     27,340     21975.6    17.83146      21960      22020

-------------------------------------------------------------------------------
-> diabetes = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
diabetes_d~e |  1,727,479    17806.94    6436.412     -36510      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
lung_cance~e |     31,884   03aug2015    3158.391  15dec1899  15apr2020

-------------------------------------------------------------------------------
-> lung_cancer = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
lung_cance~e |      2,170     21979.6    20.18025      21960      22020

-------------------------------------------------------------------------------
-> lung_cancer = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
lung_cance~e |     29,714    20181.56    3237.884     -21931      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
haem_cance~e |    102,208   05apr2008    5712.056  15jan1840  15apr2020

-------------------------------------------------------------------------------
-> haem_cancer = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
haem_cance~e |      1,752    21979.88    20.39922      21960      22020

-------------------------------------------------------------------------------
-> haem_cancer = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
haem_cance~e |    100,456    17551.39    5732.404     -43815      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
other_canc~e |    855,885   19may2009    4601.219  15dec1840  15dec2100

-------------------------------------------------------------------------------
-> other_cancer = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
other_canc~e |     14,594    21981.59    245.0406      21960      51483

-------------------------------------------------------------------------------
-> other_cancer = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
other_canc~e |    841,291    17968.11    4611.157     -43480      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
bone_marro~e |      6,052   05mar2008    4793.469  15dec1899  15apr2020

-------------------------------------------------------------------------------
-> bone_marrow_transplant = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
bone_marro~e |         49    21979.61    16.29266      21960      22020

-------------------------------------------------------------------------------
-> bone_marrow_transplant = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
bone_marro~e |      6,003    17560.62     4796.54     -21931      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chemo_radi~e |    228,916   28aug2008    4302.897  15dec1899  15aug2020

-------------------------------------------------------------------------------
-> chemo_radio_therapy = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chemo_radi~e |      3,536    21979.06    20.38843      21960      22142

-------------------------------------------------------------------------------
-> chemo_radio_therapy = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chemo_radi~e |    225,380    17706.89     4303.89     -21931      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_l~te |    116,245   24jun2009    6232.953  15dec1840  15apr2020

-------------------------------------------------------------------------------
-> chronic_liver_disease = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_l~te |      1,983    21976.79     18.4207      21960      22020

-------------------------------------------------------------------------------
-> chronic_liver_disease = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_l~te |    114,262    18004.57    6265.363     -43480      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_k~te |          0

-------------------------------------------------------------------------------
-> chronic_kidney_disease = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_k~te |          0

-------------------------------------------------------------------------------
-> chronic_kidney_disease = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_k~te |          0


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
organ_tran~e |     20,288   17may2007    5514.501  15dec1899  15apr2020

-------------------------------------------------------------------------------
-> organ_transplant = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
organ_tran~e |        162    21975.69    17.72337      21960      22020

-------------------------------------------------------------------------------
-> organ_transplant = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
organ_tran~e |     20,126    17266.22    5520.634     -21931      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dysplenia_~e |     24,984   27aug1992     8943.64  15dec1899  15apr2020

-------------------------------------------------------------------------------
-> dysplenia = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dysplenia_~e |        195    21974.41    18.32934      21960      22020

-------------------------------------------------------------------------------
-> dysplenia = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dysplenia_~e |     24,789    11848.77    8934.074     -21931      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
sickle_cel~e |      3,572   13feb1994     10122.9  15aug1888  15apr2020

-------------------------------------------------------------------------------
-> sickle_cell = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
sickle_cel~e |          8       21990    32.07135      21960      22020

-------------------------------------------------------------------------------
-> sickle_cell = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
sickle_cel~e |      3,564     12440.9    10124.17     -26070      21929


    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
ra_sle_pso~e |    890,387   11mar2002    7297.605  15jan1800  15mar3000

-------------------------------------------------------------------------------
-> ra_sle_psoriasis = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
ra_sle_pso~e |      5,034    22051.29    5055.126      21960     379926

-------------------------------------------------------------------------------
-> ra_sle_psoriasis = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
ra_sle_pso~e |    885,353    15372.54    7291.116     -58424      21929


. 
. 
. 
. * Outcome dates
. *****??? 
. 
. 
. 
. 
. ****************************************
. *  Cross-check expected relationships  *
. ****************************************
. 
. * everything vs each demographic/lifestyle
. * (i.e. vs age, sex, smoke, bmi cat, imd)
. 
. /*  Relationships between demographic/lifestyle variables  */
. 
. * agegroup, male, smoke, bmicat, imd, ethnicity
. 
. 
. /*  Relationships with demographic/lifestyle variables  */
. 
. * Relationships with age
. foreach var of varlist  chronic_respiratory_disease     ///
>                                                 asthma                       
>                            ///
>                                                 chronic_cardiac_disease      
>            ///
>                                                 diabetes                     
>                            ///
>                                                 lung_cancer                  
>                    ///
>                                                 haem_cancer                  
>                            ///
>                                                 other_cancer                 
>                    ///
>                                                 bone_marrow_transplant       
>            ///
>                                                 chemo_radio_therapy          
>            ///
>                                                 chronic_liver_disease        
>            ///
>                                                 chronic_kidney_disease       
>            ///
>                                                 organ_transplant             
>                    ///     
>                                                 spleen                       
>                            ///
>                                                 ra_sle_psoriasis             
>                    {
  2.         tab agegroup `var', r
  3. }

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Respiratory disease
   Grouped |    (excl. asthma)
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,969,474     22,122 | 5,991,596 
           |     99.63       0.37 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,841,890     34,028 | 2,875,918 
           |     98.82       1.18 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,970,496     98,995 | 3,069,491 
           |     96.77       3.23 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,231,601    174,107 | 2,405,708 
           |     92.76       7.24 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,716,743    231,487 | 1,948,230 
           |     88.12      11.88 |    100.00 
-----------+----------------------+----------
       80+ |   986,245    150,572 | 1,136,817 
           |     86.75      13.25 |    100.00 
-----------+----------------------+----------
     Total |16,716,449    711,311 |17,427,760 
           |     95.92       4.08 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |        Asthma
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,610,407    381,189 | 5,991,596 
           |     93.64       6.36 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,644,048    231,870 | 2,875,918 
           |     91.94       8.06 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,796,644    272,847 | 3,069,491 
           |     91.11       8.89 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,182,249    223,459 | 2,405,708 
           |     90.71       9.29 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,766,455    181,775 | 1,948,230 
           |     90.67       9.33 |    100.00 
-----------+----------------------+----------
       80+ | 1,038,091     98,726 | 1,136,817 
           |     91.32       8.68 |    100.00 
-----------+----------------------+----------
     Total |16,037,894  1,389,866 |17,427,760 
           |     92.02       7.98 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |     Heart disease
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,950,414     41,182 | 5,991,596 
           |     99.31       0.69 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,829,211     46,707 | 2,875,918 
           |     98.38       1.62 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,930,346    139,145 | 3,069,491 
           |     95.47       4.53 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,161,807    243,901 | 2,405,708 
           |     89.86      10.14 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,591,215    357,015 | 1,948,230 
           |     81.67      18.33 |    100.00 
-----------+----------------------+----------
       80+ |   791,413    345,404 | 1,136,817 
           |     69.62      30.38 |    100.00 
-----------+----------------------+----------
     Total |16,254,406  1,173,354 |17,427,760 
           |     93.27       6.73 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |       Diabetes
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,888,997    102,599 | 5,991,596 
           |     98.29       1.71 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,710,611    165,307 | 2,875,918 
           |     94.25       5.75 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,743,139    326,352 | 3,069,491 
           |     89.37      10.63 |    100.00 
-----------+----------------------+----------
    60-<70 | 1,993,494    412,214 | 2,405,708 
           |     82.87      17.13 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,517,468    430,762 | 1,948,230 
           |     77.89      22.11 |    100.00 
-----------+----------------------+----------
       80+ |   846,572    290,245 | 1,136,817 
           |     74.47      25.53 |    100.00 
-----------+----------------------+----------
     Total |15,700,281  1,727,479 |17,427,760 
           |     90.09       9.91 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |      Lung cancer
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,991,386        210 | 5,991,596 
           |    100.00       0.00 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,875,356        562 | 2,875,918 
           |     99.98       0.02 |    100.00 
-----------+----------------------+----------
    50-<60 | 3,067,016      2,475 | 3,069,491 
           |     99.92       0.08 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,398,660      7,048 | 2,405,708 
           |     99.71       0.29 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,936,184     12,046 | 1,948,230 
           |     99.38       0.62 |    100.00 
-----------+----------------------+----------
       80+ | 1,129,444      7,373 | 1,136,817 
           |     99.35       0.65 |    100.00 
-----------+----------------------+----------
     Total |17,398,046     29,714 |17,427,760 
           |     99.83       0.17 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |     Haem. cancer
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,982,253      9,343 | 5,991,596 
           |     99.84       0.16 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,868,185      7,733 | 2,875,918 
           |     99.73       0.27 |    100.00 
-----------+----------------------+----------
    50-<60 | 3,055,234     14,257 | 3,069,491 
           |     99.54       0.46 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,385,370     20,338 | 2,405,708 
           |     99.15       0.85 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,919,692     28,538 | 1,948,230 
           |     98.54       1.46 |    100.00 
-----------+----------------------+----------
       80+ | 1,116,570     20,247 | 1,136,817 
           |     98.22       1.78 |    100.00 
-----------+----------------------+----------
     Total |17,327,304    100,456 |17,427,760 
           |     99.42       0.58 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |      Any cancer
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,965,772     25,824 | 5,991,596 
           |     99.57       0.43 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,830,304     45,614 | 2,875,918 
           |     98.41       1.59 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,953,131    116,360 | 3,069,491 
           |     96.21       3.79 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,218,979    186,729 | 2,405,708 
           |     92.24       7.76 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,680,121    268,109 | 1,948,230 
           |     86.24      13.76 |    100.00 
-----------+----------------------+----------
       80+ |   938,162    198,655 | 1,136,817 
           |     82.53      17.47 |    100.00 
-----------+----------------------+----------
     Total |16,586,469    841,291 |17,427,760 
           |     95.17       4.83 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |   Organ transplant
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,990,484      1,112 | 5,991,596 
           |     99.98       0.02 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,875,116        802 | 2,875,918 
           |     99.97       0.03 |    100.00 
-----------+----------------------+----------
    50-<60 | 3,068,103      1,388 | 3,069,491 
           |     99.95       0.05 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,404,125      1,583 | 2,405,708 
           |     99.93       0.07 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,947,173      1,057 | 1,948,230 
           |     99.95       0.05 |    100.00 
-----------+----------------------+----------
       80+ | 1,136,756         61 | 1,136,817 
           |     99.99       0.01 |    100.00 
-----------+----------------------+----------
     Total |17,421,757      6,003 |17,427,760 
           |     99.97       0.03 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Chemotherapy or
   Grouped |     radiotherapy
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,976,747     14,849 | 5,991,596 
           |     99.75       0.25 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,858,245     17,673 | 2,875,918 
           |     99.39       0.61 |    100.00 
-----------+----------------------+----------
    50-<60 | 3,030,420     39,071 | 3,069,491 
           |     98.73       1.27 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,353,310     52,398 | 2,405,708 
           |     97.82       2.18 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,883,428     64,802 | 1,948,230 
           |     96.67       3.33 |    100.00 
-----------+----------------------+----------
       80+ | 1,100,230     36,587 | 1,136,817 
           |     96.78       3.22 |    100.00 
-----------+----------------------+----------
     Total |17,202,380    225,380 |17,427,760 
           |     98.71       1.29 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |         Liver
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,979,429     12,167 | 5,991,596 
           |     99.80       0.20 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,858,909     17,009 | 2,875,918 
           |     99.41       0.59 |    100.00 
-----------+----------------------+----------
    50-<60 | 3,041,915     27,576 | 3,069,491 
           |     99.10       0.90 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,377,263     28,445 | 2,405,708 
           |     98.82       1.18 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,927,087     21,143 | 1,948,230 
           |     98.91       1.09 |    100.00 
-----------+----------------------+----------
       80+ | 1,128,895      7,922 | 1,136,817 
           |     99.30       0.70 |    100.00 
-----------+----------------------+----------
     Total |17,313,498    114,262 |17,427,760 
           |     99.34       0.66 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

   Grouped |    Kidney disease
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,692,773    298,823 | 5,991,596 
           |     95.01       4.99 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,731,952    143,966 | 2,875,918 
           |     94.99       5.01 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,915,803    153,688 | 3,069,491 
           |     94.99       5.01 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,285,703    120,005 | 2,405,708 
           |     95.01       4.99 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,850,640     97,590 | 1,948,230 
           |     94.99       5.01 |    100.00 
-----------+----------------------+----------
       80+ | 1,079,583     57,234 | 1,136,817 
           |     94.97       5.03 |    100.00 
-----------+----------------------+----------
     Total |16,556,454    871,306 |17,427,760 
           |     95.00       5.00 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |   Organ transplant
   Grouped |       recipient
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,988,354      3,242 | 5,991,596 
           |     99.95       0.05 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,872,714      3,204 | 2,875,918 
           |     99.89       0.11 |    100.00 
-----------+----------------------+----------
    50-<60 | 3,064,291      5,200 | 3,069,491 
           |     99.83       0.17 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,400,773      4,935 | 2,405,708 
           |     99.79       0.21 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,945,384      2,846 | 1,948,230 
           |     99.85       0.15 |    100.00 
-----------+----------------------+----------
       80+ | 1,136,118        699 | 1,136,817 
           |     99.94       0.06 |    100.00 
-----------+----------------------+----------
     Total |17,407,634     20,126 |17,427,760 
           |     99.88       0.12 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Spleen problems
           |  (dysplenia, sickle
   Grouped |         cell)
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,986,950      4,646 | 5,991,596 
           |     99.92       0.08 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,871,876      4,042 | 2,875,918 
           |     99.86       0.14 |    100.00 
-----------+----------------------+----------
    50-<60 | 3,063,263      6,228 | 3,069,491 
           |     99.80       0.20 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,400,003      5,705 | 2,405,708 
           |     99.76       0.24 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,943,254      4,976 | 1,948,230 
           |     99.74       0.26 |    100.00 
-----------+----------------------+----------
       80+ | 1,134,217      2,600 | 1,136,817 
           |     99.77       0.23 |    100.00 
-----------+----------------------+----------
     Total |17,399,563     28,197 |17,427,760 
           |     99.84       0.16 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  RA, SLE, Psoriasis
   Grouped | (autoimmune disease)
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 | 5,817,598    173,998 | 5,991,596 
           |     97.10       2.90 |    100.00 
-----------+----------------------+----------
    40-<50 | 2,742,430    133,488 | 2,875,918 
           |     95.36       4.64 |    100.00 
-----------+----------------------+----------
    50-<60 | 2,892,260    177,231 | 3,069,491 
           |     94.23       5.77 |    100.00 
-----------+----------------------+----------
    60-<70 | 2,239,514    166,194 | 2,405,708 
           |     93.09       6.91 |    100.00 
-----------+----------------------+----------
    70-<80 | 1,796,779    151,451 | 1,948,230 
           |     92.23       7.77 |    100.00 
-----------+----------------------+----------
       80+ | 1,053,826     82,991 | 1,136,817 
           |     92.70       7.30 |    100.00 
-----------+----------------------+----------
     Total |16,542,407    885,353 |17,427,760 
           |     94.92       5.08 |    100.00 

. 
. 
. * Relationships with sex
. foreach var of varlist  chronic_respiratory_disease     ///
>                                                 asthma                       
>                            ///
>                                                 chronic_cardiac_disease      
>            ///
>                                                 diabetes                     
>                            ///
>                                                 lung_cancer                  
>                    ///
>                                                 haem_cancer                  
>                            ///
>                                                 other_cancer                 
>                    ///
>                                                 bone_marrow_transplant       
>            ///
>                                                 chemo_radio_therapy          
>            ///
>                                                 chronic_liver_disease        
>            ///
>                                                 chronic_kidney_disease       
>            ///
>                                                 organ_transplant             
>                    ///     
>                                                 spleen                       
>                            ///
>                                                 ra_sle_psoriasis             
>                    {
  2.         tab male `var', r
  3. }

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  Respiratory disease
           |    (excl. asthma)
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,379,363    351,458 | 8,730,821 
           |     95.97       4.03 |    100.00 
-----------+----------------------+----------
         1 | 8,337,086    359,853 | 8,696,939 
           |     95.86       4.14 |    100.00 
-----------+----------------------+----------
     Total |16,716,449    711,311 |17,427,760 
           |     95.92       4.08 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |        Asthma
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,919,220    811,601 | 8,730,821 
           |     90.70       9.30 |    100.00 
-----------+----------------------+----------
         1 | 8,118,674    578,265 | 8,696,939 
           |     93.35       6.65 |    100.00 
-----------+----------------------+----------
     Total |16,037,894  1,389,866 |17,427,760 
           |     92.02       7.98 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |     Heart disease
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,266,867    463,954 | 8,730,821 
           |     94.69       5.31 |    100.00 
-----------+----------------------+----------
         1 | 7,987,539    709,400 | 8,696,939 
           |     91.84       8.16 |    100.00 
-----------+----------------------+----------
     Total |16,254,406  1,173,354 |17,427,760 
           |     93.27       6.73 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |       Diabetes
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,929,399    801,422 | 8,730,821 
           |     90.82       9.18 |    100.00 
-----------+----------------------+----------
         1 | 7,770,882    926,057 | 8,696,939 
           |     89.35      10.65 |    100.00 
-----------+----------------------+----------
     Total |15,700,281  1,727,479 |17,427,760 
           |     90.09       9.91 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |      Lung cancer
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,715,178     15,643 | 8,730,821 
           |     99.82       0.18 |    100.00 
-----------+----------------------+----------
         1 | 8,682,868     14,071 | 8,696,939 
           |     99.84       0.16 |    100.00 
-----------+----------------------+----------
     Total |17,398,046     29,714 |17,427,760 
           |     99.83       0.17 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |     Haem. cancer
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,685,965     44,856 | 8,730,821 
           |     99.49       0.51 |    100.00 
-----------+----------------------+----------
         1 | 8,641,339     55,600 | 8,696,939 
           |     99.36       0.64 |    100.00 
-----------+----------------------+----------
     Total |17,327,304    100,456 |17,427,760 
           |     99.42       0.58 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |      Any cancer
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,250,746    480,075 | 8,730,821 
           |     94.50       5.50 |    100.00 
-----------+----------------------+----------
         1 | 8,335,723    361,216 | 8,696,939 
           |     95.85       4.15 |    100.00 
-----------+----------------------+----------
     Total |16,586,469    841,291 |17,427,760 
           |     95.17       4.83 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |   Organ transplant
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,728,348      2,473 | 8,730,821 
           |     99.97       0.03 |    100.00 
-----------+----------------------+----------
         1 | 8,693,409      3,530 | 8,696,939 
           |     99.96       0.04 |    100.00 
-----------+----------------------+----------
     Total |17,421,757      6,003 |17,427,760 
           |     99.97       0.03 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Chemotherapy or
           |     radiotherapy
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,591,971    138,850 | 8,730,821 
           |     98.41       1.59 |    100.00 
-----------+----------------------+----------
         1 | 8,610,409     86,530 | 8,696,939 
           |     99.01       0.99 |    100.00 
-----------+----------------------+----------
     Total |17,202,380    225,380 |17,427,760 
           |     98.71       1.29 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |         Liver
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,682,000     48,821 | 8,730,821 
           |     99.44       0.56 |    100.00 
-----------+----------------------+----------
         1 | 8,631,498     65,441 | 8,696,939 
           |     99.25       0.75 |    100.00 
-----------+----------------------+----------
     Total |17,313,498    114,262 |17,427,760 
           |     99.34       0.66 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Kidney disease
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,293,760    437,061 | 8,730,821 
           |     94.99       5.01 |    100.00 
-----------+----------------------+----------
         1 | 8,262,694    434,245 | 8,696,939 
           |     95.01       4.99 |    100.00 
-----------+----------------------+----------
     Total |16,556,454    871,306 |17,427,760 
           |     95.00       5.00 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |   Organ transplant
           |       recipient
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,722,672      8,149 | 8,730,821 
           |     99.91       0.09 |    100.00 
-----------+----------------------+----------
         1 | 8,684,962     11,977 | 8,696,939 
           |     99.86       0.14 |    100.00 
-----------+----------------------+----------
     Total |17,407,634     20,126 |17,427,760 
           |     99.88       0.12 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |    Spleen problems
           |  (dysplenia, sickle
           |         cell)
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,717,891     12,930 | 8,730,821 
           |     99.85       0.15 |    100.00 
-----------+----------------------+----------
         1 | 8,681,672     15,267 | 8,696,939 
           |     99.82       0.18 |    100.00 
-----------+----------------------+----------
     Total |17,399,563     28,197 |17,427,760 
           |     99.84       0.16 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |  RA, SLE, Psoriasis
           | (autoimmune disease)
      Male |         0          1 |     Total
-----------+----------------------+----------
         0 | 8,236,580    494,241 | 8,730,821 
           |     94.34       5.66 |    100.00 
-----------+----------------------+----------
         1 | 8,305,827    391,112 | 8,696,939 
           |     95.50       4.50 |    100.00 
-----------+----------------------+----------
     Total |16,542,407    885,353 |17,427,760 
           |     94.92       5.08 |    100.00 

. 
. 
. /*  Relationships between conditions  */
. 
. 
. * Respiratory
. tab chronic_respiratory_disease asthma 

Respirator |
 y disease |
    (excl. |        Asthma
   asthma) |         0          1 |     Total
-----------+----------------------+----------
         0 |15,520,298  1,196,151 |16,716,449 
         1 |   517,596    193,715 |   711,311 
-----------+----------------------+----------
     Total |16,037,894  1,389,866 |17,427,760 

. 
. * Cardiac
. tab diabetes chronic_cardiac_disease

           |     Heart disease
  Diabetes |         0          1 |     Total
-----------+----------------------+----------
         0 |14,903,418    796,863 |15,700,281 
         1 | 1,350,988    376,491 | 1,727,479 
-----------+----------------------+----------
     Total |16,254,406  1,173,354 |17,427,760 

. *tab chronic_cardiac_disease bpcat
. 
. 
. 
. 
. 
. 
. 
. ********************************************
. *  Cross-check logical date relationships  *
. ********************************************
. 
. * Cross check dates of hosp/itu/death??
. 
. 
. 
. 
. 
. 
. *****************************
. *  Check survival settings  *
. *****************************
. /*
> * Death
> stset stime_died, fail(died) enter(enter_date) origin(enter_date) id(patient_
> id) 
> sort _t
> gen cum_died = sum(_d)
> line cum_died _t, sort(_t)
> graph export "output/events_died.eps", replace as(eps)
> 
> * Hospitalised for Covid
> stset stime_hosp, fail(hosp) enter(enter_date) origin(enter_date) id(patient_
> id) 
> sort _t
> gen cum_hosp = sum(_d)
> line cum_hosp _t, sort(_t)
> graph export "output/events_hosp.eps", replace as(eps)
> 
> 
> * ITU admission for Covid
> stset stime_itu, fail(itu) enter(enter_date) origin(enter_date) id(patient_id
> ) 
> sort _t
> gen cum_itu = sum(_d)
> line cum_itu _t, sort(_t)
> graph export "output/events_itu.eps", replace as(eps)
> */
. 
. 
. 
. 
. * Close log file 
. log close
      name:  <unnamed>
       log:  E:\analyses\opencorona-risk-factors-research\analysis\output/an_ch
> ecks.log
  log type:  text
 closed on:  22 Apr 2020, 08:41:25
-------------------------------------------------------------------------------
